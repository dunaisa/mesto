(()=>{"use strict";var e=document.querySelector(".popup-open-pic"),t=document.querySelector(".popup__image-figcaption"),n=document.querySelector(".popup__image-figure");function r(e){e.classList.add("popup_opened"),document.addEventListener("keydown",i)}function o(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",i)}function i(e){"Escape"===e.key&&o(document.querySelector(".popup_opened"))}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){function o(i,a,l){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),c(this,"_getTemplate",(function(){return document.querySelector(s._elementTemplate).content.querySelector(".element").cloneNode(!0)})),c(this,"_removeCard",(function(){s._element.remove()})),c(this,"_handleLikePost",(function(){s._likeBtn.classList.toggle("element__like-btn_active")})),c(this,"_handleOpenPic",(function(){n.src=s._link,n.alt=s._name,t.textContent=s._name,r(e)})),c(this,"_setEventListeners",(function(){s._deleteCardBtn.addEventListener("click",(function(){s._removeCard()})),s._image.addEventListener("click",(function(){s._handleOpenPic()})),s._likeBtn.addEventListener("click",(function(){s._handleLikePost()}))})),this._name=i,this._link=a,this._elementTemplate=l}var i,l;return i=o,(l=[{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._image=this._element.querySelector(".element__image"),this._image.src=this._link,this._image.alt=this._name,this._element.querySelector(".element__info-heading").textContent=this._name,this._likeBtn=this._element.querySelector(".element__like-btn"),this._deleteCardBtn=this._element.querySelector(".element__delete-btn"),this._setEventListeners(),this._element}}])&&a(i.prototype,l),Object.defineProperty(i,"prototype",{writable:!1}),o}();function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={inputSelector:"popup-form__text",submitButtonSelector:"popup-form__btn",inactiveButtonClass:"popup-form__btn_inactive",inputErrorClass:"popup-form__text_type_error",errorClass:"popup-form__input-error_active"},_=u((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"_showInputError",(function(e,t){var n=r._form.querySelector(".".concat(e.id,"-error"));e.classList.add(r._inputErrorClass),n.classList.add(r._errorClass),n.textContent=t})),p(this,"_hideInputError",(function(e){var t=r._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(r._inputErrorClass),t.classList.remove(r._errorClass),t.textContent=""})),p(this,"_checkInputValidity",(function(e){if(e.validity.valid)r._hideInputError(e);else{var t=e.validationMessage;r._showInputError(e,t)}})),p(this,"_hasInvalidInput",(function(e){return e.some((function(e){return!e.validity.valid}))})),p(this,"_toggleButtonState",(function(e,t){r._hasInvalidInput(e)?(t.classList.add(r._inactiveButtonClass),t.disabled=!0):(t.classList.remove(r._inactiveButtonClass),t.disabled=!1)})),p(this,"enableValidation",(function(){var e=Array.from(r._form.querySelectorAll(".".concat(r._inputSelector))),t=r._form.querySelector(".".concat(r._submitButtonSelector));e.forEach((function(n){n.addEventListener("input",(function(){r._checkInputValidity(n),r._toggleButtonState(e,t)}))})),r._toggleButtonState(e,t)})),p(this,"cleanUpForm",(function(){var e=Array.from(r._form.querySelectorAll(".".concat(r._inputSelector))),t=r._form.querySelector(".".concat(r._submitButtonSelector));e.forEach((function(e){r._hideInputError(e)})),r._toggleButtonState(e,t)})),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._form=n})),m=document.querySelector(".profile__edit-btn"),f=document.querySelector(".profile__add-btn"),h=document.querySelector(".popup-edit-profile"),v=document.querySelector(".popup-add-place"),y=document.querySelector(".popup-form_profile"),b=document.querySelector(".profile__subtitle"),S=y.querySelector(".popup-form__text_type_description"),g=document.querySelector(".profile__title"),k=y.querySelector(".popup-form__text_type_author-name"),C=document.querySelector(".popup-form_place"),E=C.querySelector(".popup-form__text_type_place-name"),q=C.querySelector(".popup-form__text_type_place-reference"),L=document.querySelectorAll(".popup"),x=document.querySelector(".elements");function B(e,t,n){return new l(e,t,n).generateCard()}function w(e){x.prepend(e)}C.addEventListener("submit",(function(e){e.preventDefault(),w(B(E.value,q.value,"#template-elements")),o(v),e.target.reset()})),[{name:"Карачаевск",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Гора Эльбрус",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Пятигорск",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Канада",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Франция",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Германия",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(e){w(B(e.name,e.link,"#template-elements"))}));var j={};Array.from(document.forms).forEach((function(e){j[e.name]=new _(d,e),j[e.name].enableValidation()})),L.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&o(e),t.target.classList.contains("popup__close-btn")&&o(e)}))})),m.addEventListener("click",(function(e){k.value=g.textContent,S.value=b.textContent,j[y.name].cleanUpForm(),r(h)})),f.addEventListener("click",(function(e){C.reset(),j[C.name].cleanUpForm(),r(v)})),y.addEventListener("submit",(function(e){!function(e){e.preventDefault(),g.textContent=k.value,b.textContent=S.value}(e),o(h)}))})();